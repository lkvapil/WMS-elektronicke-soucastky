@startuml 02c_graph_model
hide circle
!theme cerulean-outline
title WMS Elektronické součástky\n③ Konsolidovaný model pro grafovou databázi (Neo4j)

skinparam backgroundColor #FAFAFA
skinparam classBackgroundColor #D5F5E3
skinparam classBorderColor #27AE60
skinparam classArrowColor #1D8348
skinparam classFontSize 11
skinparam noteBackgroundColor #FFFDE7
skinparam noteBorderColor #F9A825

'══════════════════════════════════════════════════════════════════════════════
'  UZLY – hierarchie komponent
'  V Neo4j se dědičnost implementuje pomocí vícenásobných labelů:
'  (:Komponenta:PasivniKomponenta:Rezistor)
'  IS_A hrany vyjadřují typovou hierarchii.
'══════════════════════════════════════════════════════════════════════════════

class Komponenta {
  id : String
  partNumber : String
  name : String
  manufacturer : String
  barcode : String
  minStock : Integer
  description : String
}

class PasivniKomponenta {
  value : String
  unit : String
  tolerance : String
  voltageRating : String
}

class AktivniKomponenta {
  maxVoltage : String
  maxCurrent : String
  technology : String
}

class Konektor {
  pinCount : Integer
  pitch : String
  mounting : String
  gender : String
}

class Rezistor {
  powerRating : String
  tempCoefficient : String
}

class Kondenzator {
  capacitance : String
  dielectricType : String
  esr : String
}

class Induktor {
  inductance : String
  saturationCurrent : String
}

class Tranzistor {
  transistorType : String
  hfe : String
  maxPower : String
}

class IntegrovanyObvod {
  icFamily : String
  pinCount : Integer
  operatingVoltage : String
}

class Dioda {
  diodeType : String
  forwardVoltage : String
  reverseVoltage : String
}

'── IS_A hrany – typová hierarchie ──────────────────────────────────────────
PasivniKomponenta  "*" --> "1" Komponenta       : IS_A
AktivniKomponenta  "*" --> "1" Komponenta       : IS_A
Konektor           "*" --> "1" Komponenta       : IS_A
Rezistor           "*" --> "1" PasivniKomponenta : IS_A
Kondenzator        "*" --> "1" PasivniKomponenta : IS_A
Induktor           "*" --> "1" PasivniKomponenta : IS_A
Tranzistor         "*" --> "1" AktivniKomponenta : IS_A
IntegrovanyObvod   "*" --> "1" AktivniKomponenta : IS_A
Dioda              "*" --> "1" AktivniKomponenta : IS_A

'══════════════════════════════════════════════════════════════════════════════
'  KATEGORIE
'══════════════════════════════════════════════════════════════════════════════

class Kategorie {
  id : String
  name : String
  description : String
  icon : String
}

Komponenta "*" --> "1" Kategorie : PATRI_DO

'══════════════════════════════════════════════════════════════════════════════
'  SKLADOVÁ MÍSTA
'══════════════════════════════════════════════════════════════════════════════

class SkladoveMisto {
  id : String
  code : String
  name : String
  section : String
  shelf : String
  bin : String
  capacity : Integer
}

'── Hrana s atributy – asociační třída ULOZENA_NA ───────────────────────────
class ULOZENA_NA {
  quantity : Integer
  reservedQty : Integer
  unitPrice : Float
  updatedAt : DateTime
}

note top of ULOZENA_NA
  <<edge class>>
  Atributy hrany
  Komponenta → SkladoveMisto
end note

Komponenta "*" --> "*" SkladoveMisto
(Komponenta, SkladoveMisto) .. ULOZENA_NA

'══════════════════════════════════════════════════════════════════════════════
'  DODAVATELÉ
'  Kvalifikovaná vazba → hrana s atributy katalogCislo
'══════════════════════════════════════════════════════════════════════════════

class Dodavatel {
  id : String
  name : String
  code : String
  email : String
  phone : String
  leadTimeDays : Integer
}

'── Hrana s atributy – asociační třída DODAVANA_OD ──────────────────────────
class DODAVANA_OD {
  katalogCislo : String
  unitPrice : Float
  minOrderQty : Integer
}

note top of DODAVANA_OD
  <<edge class>>
  katalogCislo odpovídá
  kvalifikátoru z konceptuálního modelu
end note

Komponenta "*" --> "*" Dodavatel
(Komponenta, Dodavatel) .. DODAVANA_OD

'══════════════════════════════════════════════════════════════════════════════
'  OBJEDNÁVKY
'══════════════════════════════════════════════════════════════════════════════

class Objednavka {
  id : String
  orderNumber : String
  status : String
  orderDate : Date
  expectedDelivery : Date
  totalAmount : Float
}

'── Hrana s atributy – asociační třída OBSAHUJE ─────────────────────────────
class OBSAHUJE {
  quantityOrdered : Integer
  quantityReceived : Integer
  unitPrice : Float
}

note top of OBSAHUJE
  <<edge class>>
  Atributy hrany
  Objednavka → Komponenta
end note

Objednavka "*"    --> "1" Dodavatel : OBJEDNANA_U
Objednavka "*"    --> "*" Komponenta
(Objednavka, Komponenta) .. OBSAHUJE

'══════════════════════════════════════════════════════════════════════════════
'  UŽIVATELÉ
'══════════════════════════════════════════════════════════════════════════════

class Uzivatel {
  id : String
  username : String
  email : String
  role : String
  fullName : String
}

Objednavka "*" --> "1" Uzivatel : VYTVORIL

'══════════════════════════════════════════════════════════════════════════════
'  PROJEKTY
'══════════════════════════════════════════════════════════════════════════════

class Projekt {
  id : String
  code : String
  name : String
  status : String
}

'══════════════════════════════════════════════════════════════════════════════
'  POHYBY ZÁSOB
'══════════════════════════════════════════════════════════════════════════════

class PohybZasob {
  id : String
  movementType : String
  quantity : Integer
  unitPrice : Float
  reference : String
  createdAt : DateTime
}

PohybZasob "*"    --> "1"    Komponenta    : TYKA_SE
PohybZasob "*"    --> "0..1" SkladoveMisto : Z_MISTA
PohybZasob "*"    --> "0..1" SkladoveMisto : NA_MISTO
PohybZasob "*"    --> "0..1" Projekt       : VYDANA_NA
PohybZasob "*"    --> "1"    Uzivatel      : PROVEDL

'══════════════════════════════════════════════════════════════════════════════
'  INVENTURA
'  Hrana INVENTARIZUJE s atributy (asociační třída)
'══════════════════════════════════════════════════════════════════════════════

class InventurniCyklus {
  id : String
  startDate : DateTime
  endDate : DateTime
  status : String
}

class INVENTARIZUJE {
  expectedQty : Integer
  countedQty : Integer
  difference : Integer
  isConfirmed : Boolean
}

note top of INVENTARIZUJE
  <<edge class>>
  Atributy hrany
  InventurniCyklus → SkladoveMisto
end note

InventurniCyklus "*" --> "1"  Uzivatel      : ZAHAJIL
InventurniCyklus "*" --> "1..*" SkladoveMisto
(InventurniCyklus, SkladoveMisto) .. INVENTARIZUJE

@enduml
